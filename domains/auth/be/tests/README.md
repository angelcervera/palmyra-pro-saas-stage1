Auth domain — tests

Table‑driven unit tests for services and handlers. Use httptest for handlers and assert RFC7807 ProblemDetails on error paths.
